Here are the OpenSSL command line tools commands to achieve the desired tasks:

    To generate a self-signed root certificate and write it to file root.pem, run the following command:

openssl req -x509 -newkey rsa:2048 -keyout root.key -out root.pem -days 365 -subj "/CN=Root CA"

This command generates a new 2048-bit RSA private key and a self-signed root certificate with a validity period of 365 days. The subject of the certificate is set to "CN=Root CA". The private key is saved to the file "root.key" and the certificate is saved to the file "root.pem".

    To generate an intermediate certificate and sign it with the root certificate from step 1, save it to intermediate.pem, run the following command:

openssl req -new -newkey rsa:2048 -keyout intermediate.key -out intermediate.csr -subj "/CN=Intermediate CA"
#openssl x509 -req -in intermediate.csr -CA root.pem -CAkey root.key -CAcreateserial -out intermediate.pem -days 365
openssl x509 -req -in intermediate.csr -CA root.pem -CAkey root.key -CAcreateserial -out intermediate.pem -days 365 -extfile <(printf "basicConstraints=critical,CA:true,pathlen:0\nkeyUsage=critical,keyCertSign,cRLSign\n")

This command generates a new 2048-bit RSA private key and a Certificate Signing Request (CSR) for an intermediate certificate with a subject of "CN=Intermediate CA". The CSR is saved to the file "intermediate.csr" and the private key is saved to the file "intermediate.key". The second command signs the CSR with the root certificate from step 1 and saves the resulting intermediate certificate to the file "intermediate.pem".

    To generate a leaf certificate and sign it with the intermediate certificate from step 2, save it to leaf.pem, run the following command:

openssl req -new -newkey rsa:2048 -keyout leaf.key -out leaf.csr -subj "/CN=Leaf Certificate"
openssl x509 -req -in leaf.csr -CA intermediate.pem -CAkey intermediate.key -CAcreateserial -out leaf.pem -days 365

This command generates a new 2048-bit RSA private key and a CSR for a leaf certificate with a subject of "CN=Leaf Certificate". The CSR is saved to the file "leaf.csr" and the private key is saved to the file "leaf.key". The second command signs the CSR with the intermediate certificate from step 2 and saves the resulting leaf certificate to the file "leaf.pem".

    To save the generated certificates from steps 1, 2, and 3 in a pem file named chain.pem, run the following command:

cat root.pem intermediate.pem leaf.pem > chain.pem

This command concatenates the contents of the root, intermediate, and leaf certificates and saves the resulting chain to the file "chain.pem".
